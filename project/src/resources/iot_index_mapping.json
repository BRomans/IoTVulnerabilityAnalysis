//PUT iot
{
	"mappings": {
	  "device": {
		"properties": {
		  "city": {
		    "type": "text",
		    "fielddata": true,
		    "fields": {
		      "keyword": {
		        "type": "keyword"         
		      }
		    }
		  },
		  "country_code": {
		    "type": "text",
		    "fielddata": true,
		    "fields": {
		      "keyword": {
		        "type": "keyword",
		        "ignore_above": 20
		      }
		    }
		  },
		  "country_name": {
		    "type": "text",
		    "fielddata": true,
		    "fields": {
		      "keyword": {
		        "type": "keyword"  
		      }
		    }
		  },
		  "create_timestamp": {
		    "type": "date"
		  },
		  "data": {
		    "properties": {
		      "location": {
		        "properties": {
		          "area_code": {
		            "type": "long"
		          },
		          "city": {
		            "type": "text",
		            "fields": {
		              "keyword": {
		                "type": "keyword"
		              }
		            }
		          },
		          "country_code": {
		            "type": "text",
		            "fields": {
		              "keyword": {
		                "type": "keyword",
		                "ignore_above": 20
		              }
		            }
		          },
		          "country_code3": {
		            "type": "text",
		            "fields": {
		              "keyword": {
		                "type": "keyword"
		              }
		            }
		          },
		          "country_name": {
		            "type": "text",
		            "fields": {
		              "keyword": {
		                "type": "keyword"
		              }
		            }
		          },
		          "dma_code": {
		            "type": "long"
		          },
		          "latitude": {
		            "type": "double"
		          },
		          "longitude": {
		            "type": "double"
		          },
		          "postal_code": {
		            "type": "text",
		            "fields": {
		              "keyword": {
		                "type": "keyword"
		              }
		            }
		          },
		          "region_code": {
		            "type": "text",
		            "fields": {
		              "keyword": {
		                "type": "keyword"
		              }
		            }
		          }
		        }
		      },
		      "os": {
		        "type": "text",
		        "fielddata": true,
		        "fields": {
		          "keyword": {
		            "type": "keyword",
		            "ignore_above": 256
		          }
		        }
		      },
		      "port": {
		        "type": "text",
		        "fielddata": true,
		        "fields": {
		          "keyword": {
		            "type": "keyword",
		            "ignore_above": 10
		          }
		        }
		      },
		      "product": {
		        "type": "text",
		        "fielddata": true,
		        "fields": {
		          "keyword": {
		            "type": "keyword"
		          }
		        }
		      },
			  "http": {
				"type": "text",
				"fields": {
				  "keyword": {
					"type": "keyword"
				  }
				}
			  },
		      "ssh": {
		        "properties": {
		          "cipher": {
		            "type": "text",
		            "fields": {
		              "keyword": {
		                "type": "keyword"
		              }
		            }
		          },
		          "fingerprint": {
		            "type": "text",
		            "fields": {
		              "keyword": {
		                "type": "keyword"
		              }
		            }
		          },
		          "kex": {
		            "properties": {
		              "compression_algorithms": {
		                "type": "text",
		                "fields": {
		                  "keyword": {
		                    "type": "keyword"
		                  }
		                }
		              },
		              "encryption_algorithms": {
		                "type": "text",
		                "fields": {
		                  "keyword": {
		                    "type": "keyword"
		                  }
		                }
		              },
		              "kex_algorithms": {
		                "type": "text",
		                "fields": {
		                  "keyword": {
		                    "type": "keyword"
		                  }
		                }
		              },
		              "kex_follows": {
		                "type": "boolean"
		              },
		              "languages": {
		                "type": "text",
		                "fields": {
		                  "keyword": {
		                    "type": "keyword"
		                  }
		                }
		              },
		              "mac_algorithms": {
		                "type": "text",
		                "fields": {
		                  "keyword": {
		                    "type": "keyword"
		                  }
		                }
		              },
		              "server_host_key_algorithms": {
		                "type": "text",
		                "fields": {
		                  "keyword": {
		                    "type": "keyword"
		                  }
		                }
		              },
		              "unused": {
		                "type": "text",
		                "fields": {
		                  "keyword": {
		                    "type": "keyword"
		                  }
		                }
		              }
		            }
		          },
		          "key": {
		            "type": "text",
		            "fields": {
		              "keyword": {
		                "type": "keyword"
		              }
		            }
		          },
		          "mac": {
		            "type": "text",
		            "fields": {
		              "keyword": {
		                "type": "keyword"
		              }
		            }
		          },
		          "type": {
		            "type": "text",
		            "fields": {
		              "keyword": {
		                "type": "keyword"
		              }
		            }
		          }
		        }
		      },
		      "title": {
		        "type": "text",
		        "fielddata": true,
		        "fields": {
		          "keyword": {
		            "type": "keyword"
		          }
		        }
		      },
		      "transport": {
		        "type": "text",
		        "fields": {
		          "keyword": {
		            "type": "keyword"
		          }
		        }
		      },
		      "version": {
		        "type": "text",
		        "fields": {
		          "keyword": {
		            "type": "keyword"
		          }
		        }
		      }
		    }
		  },
		  "ip_str": {
		    "type": "text",
		    "fields": {
		      "keyword": {
		        "type": "keyword"
		      }
	    	}
		  },			
		  "coordinates": {
		    "type": "geo_point"
		  },	  
		  "ports": {
		    "type": "text",
		    "fielddata": true
		  },
		  "postal_code": {
		    "type": "text",
		    "fields": {
		      "keyword": {
		        "type": "keyword"
		      }
		    }
		  },
		  "search_timestamp": {
		    "type": "date",
		    "format": "epoch_second"
		  },
		  "size_data": {
		    "type": "long"
		  },
		  "type": {
		    "type": "text",
		    "fields": {
		      "keyword": {
		        "type": "keyword"
		      }
		    }
		  },
		  "vulns": {
		    "type": "text",
		    "fielddata": true,
		    "fields": {
		      "keyword": {
		        "type": "keyword"
		      }
		    }
		  },
		  "net_procolos_vuln_count": {
		  	"type": "integer"
		  },
		  "net_protocols_risk_level": {
		  	"type": "text",
		  	"fielddata":true
		  },
		  "cve_vuln_count": {
		  	"type": "integer"
		  },
		  "cve_risk_level": {
			"type": "text",
		  	"fielddata":true
		  }
		}
	  }
	}
}